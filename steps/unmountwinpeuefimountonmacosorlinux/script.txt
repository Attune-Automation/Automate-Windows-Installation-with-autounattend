if ! {kickstartedBootLoaderIsBios} && {kickstartedBootLoaderIsUefi}
then

    MOUNT_PATH="{automationWorkerLinuxBaseDirectory}/build-winpe-iso/uefi_mount"
    
    if [[ -f /etc/redhat-release ]] || [[ -f /etc/lsb-release ]] || [[ -f /etc/debian_version ]]
    then
        
        if df -h | grep --ignore-case --quiet "$(echo ${MOUNT_PATH}/*)"
        then
        
            cd "{automationWorkerLinuxBaseDirectory}/build-winpe-iso"
            umount --verbose "$(echo ${MOUNT_PATH}/*)"
            
        else
        
            echo "${MOUNT_PATH} is not mounted. Skipping."
        fi

    elif [[ "Darwin" == "$(uname)" ]]
    then
    
        if [[ -d "$(echo ${MOUNT_PATH}/*)" ]]
        then
        
            hdiutil detach "$(echo ${MOUNT_PATH}/*)"
        else
        
            echo "${MOUNT_PATH} is not mounted. Skipping."
        fi

    else
        
        echo "Unsupported operating system."
        exit 1
    fi
    
elif {kickstartedBootLoaderIsBios} && ! {kickstartedBootLoaderIsUefi}
then

    echo "Skipping, not required for BIOS boot."
    
else

    echo "Plan configuration error. Check the UEFI and BIOS parameters."
    exit 1
fi
