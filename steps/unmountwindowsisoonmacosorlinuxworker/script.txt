MOUNT_FOLDER="winimg"
BUILD_DIRECTORY="{automationWorkerLinuxBaseDirectory}/build-winpe-iso"
MOUNT_PATH="${BUILD_DIRECTORY}/${MOUNT_FOLDER}"

if [[ -f /etc/redhat-release ]] || [[ -f /etc/lsb-release ]] || [[ -f /etc/debian_version ]]
then
    if df -h | grep --ignore-case --quiet "${MOUNT_PATH}"
    then
    
        cd "${BUILD_DIRECTORY}"
        umount --verbose "${MOUNT_FOLDER}"
    else
    
        echo "${MOUNT_PATH} is not mounted. Skipping."
    fi
elif [[ "$(uname)" == "Darwin" ]]
then
    
    if [[ -d "$(echo ${MOUNT_PATH}/*)" ]]
    then
    
        hdiutil detach $(echo ${MOUNT_PATH}/*)
    else
    
        echo "${MOUNT_PATH} is not mounted. Skipping."
    fi
    
else
    
    echo "Unsupported operating system."
fi
