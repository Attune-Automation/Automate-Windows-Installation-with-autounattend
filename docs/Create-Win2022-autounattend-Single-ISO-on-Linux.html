
<!doctype html>
<html lang="en">




<head>
    <title>How to Create Win2022 autounattend Single ISO on Linux - Attune Automation</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="title"
          content="How to Create Win2022 autounattend Single ISO on Linux - Attune Automation">
    <meta name="description"
          content="Creates a single Windows Server 2022 ISO with `autounattend.xml` for unattended installation.

The ISO will be created at `{ksAttuneBaseDir}/kickstart_{kickstartedNode.fqn}.iso`.

For both BIOS and UEFI kickstarts.

For BIOS kickstarts please set `isWinServerBios` to the string 'true'.

For UEFI kic">
    <meta name="robots"
          content="follow, index, max-snippet:-1, max-video-preview:-1, max-image-preview:large">

    <meta property="og:locale" content="en_AU" />
    <meta property="og:type" content="article" />
    <meta property="og:title"
          content="HowTo Create Win2022 autounattend Single ISO on Linux - Attune Automation" />
    <meta property="og:description" content="Creates a single Windows Server 2022 ISO with `autounattend.xml` for unattended installation.

The ISO will be created at `{ksAttuneBaseDir}/kickstart_{kickstartedNode.fqn}.iso`.

For both BIOS and UEFI kickstarts.

For BIOS kickstarts please set `isWinServerBios` to the string 'true'.

For UEFI kic" />
    <meta property="og:site_name" content="Attune Automation" />
    <meta property="article:section" content="IT Instruction" />

    <meta name="twitter:title"
          content="How to Create Win2022 autounattend Single ISO on Linux - Attune Automation" />
    <meta name="twitter:description" content="Creates a single Windows Server 2022 ISO with `autounattend.xml` for unattended installation.

The ISO will be created at `{ksAttuneBaseDir}/kickstart_{kickstartedNode.fqn}.iso`.

For both BIOS and UEFI kickstarts.

For BIOS kickstarts please set `isWinServerBios` to the string 'true'.

For UEFI kic" />

    <link rel="icon" href="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-32x32.png" sizes="32x32">
    <link rel="icon" href="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-192x192.png" sizes="192x192">
    <link rel="apple-touch-icon" href="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-180x180.png">
    <meta name="msapplication-TileImage" content="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-270x270.png">
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
          crossorigin="anonymous">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="styles/style.css">

    <!-- Google tag (gtag.js) -->
    <script async
            src="https://www.googletagmanager.com/gtag/js?id=G-5TZQZNDJCD"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-5TZQZNDJCD');
    </script>
</head>


<body>

<!-- Project NavBar -->

<div class="bg-white border-bottom box-shadow sticky-top mb-3">
<div class="container px-0">
    <div class="row px-0">
        <div class="col d-flex flex-column flex-lg-row align-items-center px-0
            py-3">
            <a class="navbar-brand my-0 mr-lg-auto"
                  href="https://www.servertribe.com/"
                  target="_blank">
                    <img
                        src="https://www.servertribe.com/wp-content/uploads/2022/06/AttuneLogoV2_powered_by.png"
                        alt="Attune - Powered by ServerTribe"
                        class="img-fluid navbar-img">
            </a>
            <nav class="my-2 my-lg-0 mr-lg-3">
                <a class="p-2 text-dark" href="http://doc.servertribe.com/"
                   target="_blank">
                    Documentation
                </a>
                <a class="p-2 text-dark"
                   href="https://discord.com/invite/3YpJsagqUn"
                   target="_blank">
                    Discord
                </a>
                <a class="p-2 text-dark" href="https://github.com/Attune-Automation"
                   target="_blank">
                    GitHub
                </a>
                <a class="p-2 text-dark" href="https://www.servertribe.com/learn/"
                   target="_blank">
                    Learn
                </a>
            </nav>
            <a class="btn btn-outline-primary"
               href="https://www.servertribe.com/download-attune-registration/"
               target="_blank">
                Download NOW!
            </a>
        </div>
    </div>
</div></div>

<!-- Project breadcrumbs -->

<!-- Project breadcrumbs -->
<div class="container px-0">
    <div class="row">
        <nav class="col px-0" aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item">
                    <a href="index.html">
                    Automate Windows Installation with autounattend
                    </a>
                </li>
                <li class="breadcrumb-item active" aria-current="page">
                    <strong>Create Win2022 autounattend Single ISO on Linux</strong>
                </li>
            </ol>
        </nav>
    </div>
</div>

<!-- Blueprint Header -->

<div class="container px-0">
    <!-- Blueprint name and description -->
    <div class="row">
        <div class="col px-0">
            <h1 class="text-left">
                How to Create Win2022 autounattend Single ISO on Linux
            </h1>
        </div>
    </div>

<!-- Blueprint Description -->
    <div class="row">
        <div class="description col px-0">
            <p class="text-left">
                <p>Creates a single Windows Server 2022 ISO with <code>autounattend.xml</code> for unattended installation.</p>
<p>The ISO will be created at <code>{ksAttuneBaseDir}/kickstart_{kickstartedNode.fqn}.iso</code>.</p>
<p>For both BIOS and UEFI kickstarts.</p>
<p>For BIOS kickstarts please set <code>isWinServerBios</code> to the string 'true'.</p>
<p>For UEFI kickstarts please set <code>isWinServerUefi</code> to the string 'true'.</p>
<p>Please set <code>isWinPEKickstart</code> to the string 'false'.</p>
<p>This blueprint assumes the drivers drop in directory is at <code>{automationWorkerBaseDirectory}/drivers-{newOsNode.fqn}</code> and has the correct drivers dropped in.</p>
            </p>
        </div>
    </div>
    <div class="row pt-4">
        <div class="col-6 px-0">
            <h6 class="text-left">
                This documentation is generated by
                <a href="https://www.servertribe.com/"
                    class="badge badge-primary"
                    target="_blank">
                    Attune
                </a>
            </h6>
        </div>
        <div class="col-6 align-self-end text-right px-0">
            <h6 class="text-right">
                <a href="https://www.youtube.com/@servertribe"
                    class="badge badge-secondary"
                    target="_blank">
                    YouTube
                </a>
                <a href="https://github.com/Attune-Automation"
                    class="badge badge-secondary"
                    target="_blank">
                    GitHub
                </a>
                <a href="https://discord.com/invite/3YpJsagqUn"
                    class="badge badge-secondary"
                    target="_blank">
                    Discord
                </a>
                <a href="https://www.linkedin.com/company/servertribe/"
                    class="badge badge-secondary"
                    target="_blank">
                    LinkedIn
                </a>
                <a href="http://doc.servertribe.com/"
                    class="badge badge-secondary"
                    target="_blank">
                    Documentation
                </a>
            </h6>
        </div>
    </div>
    <hr>
</div>

<div class="documentation">
    <div class="container px-0">
        <div class="row">

<!-- Blueprint ToC -->


            <div class="toc col-lg-2 px-0 pr-5">
                <div class="container px-0 pt-3">
                    <p class="pb-2">
                        <strong>Contents</strong>
                    </p>
                    <p class="text-muted">
                        <a href="#top">
                            <strong>Create Win2022 autounattend Single ISO on Linux</strong>
                        </a>
                    </p>


    
        

                    <p class="text-muted pt-2">
                        <a href="#checkinputparametervaluesforwindowsserversingleisokickstart">
                            <strong>Step 1 -</strong> Check Input Parameter Values for Windows Server Single ISO Kickstart
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#cleanupbuildfilesandisos">
                            <strong>Step 2 -</strong> Clean Up Build Files and ISOs
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#deploywin2022dvdiso">
                            <strong>Step 3 -</strong> Deploy Win2022 DVD ISO
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#extractwindowsbootimg">
                            <strong>Step 4 -</strong> Extract Windows boot.img
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#extractwindowsiso">
                            <strong>Step 5 -</strong> Extract Windows ISO
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#deploypostsetuppowershellscript">
                            <strong>Step 6 -</strong> Deploy Post Setup PowerShell Script
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#deploywindowsunattendedconfig">
                            <strong>Step 7 -</strong> Deploy Windows Unattended Config
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#copydriversdropinfolder">
                            <strong>Step 8 -</strong> Copy Drivers Drop in Folder
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#createbiosbootiso">
                            <strong>Step 9 -</strong> Create BIOS Boot ISO
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#performcreateuefiforsingleiso">
                            <strong>Step 10 -</strong> Perform Create UEFI for Single ISO
                        </a>
                    </p>
    
        

                    <p class="text-muted pt-2">
                        <a href="#createemptyuefiforsingleiso">
                            <strong>Step 10.1 -</strong> Create Empty UEFI for Single ISO 
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#mountemptyuefiforsingleiso">
                            <strong>Step 10.2 -</strong> Mount Empty UEFI for Single ISO
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#movefilestouefimount">
                            <strong>Step 10.3 -</strong> Move Files to UEFI Mount
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#unmountsingleisouefimount">
                            <strong>Step 10.4 -</strong> Unmount Single ISO UEFI Mount
                        </a>
                    </p>


        

                    <p class="text-muted pt-2">
                        <a href="#cleanupbuildfilesanddriversfiles">
                            <strong>Step 11 -</strong> Clean up Build Files and Drivers Files
                        </a>
                    </p>


                </div>
            </div>

<!-- Blueprint Contents -->
            <div class="col-lg-8 pt-3">
                <div class="container">


        <div class="jumbotron">
            <p class="display-3 text-center">
                <strong>Automate This</strong>
            </p>
            <p class="lead text-center">
                Use the <strong>Attune GUI</strong> for your Scripts
            </p>
            <p class="lead">
                <ol>
                    <a href="https://www.servertribe.com/download-attune-registration/"
                        target="_blank">
                        <span class="badge badge-primary">1</span>
                        Download Attune
                        <i class="fa-solid fa-download fa-beat-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://github.com/attune-Automation/"
                        target="_blank">
                        <span class="badge badge-primary">2</span>
                         Copy the Attune Project URL
                         <i class="fa-brands fa-github fa-fade"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://servertribe-attune.readthedocs.io/en/latest/howto/design_workspace/clone_project.html"
                        target="_blank">
                        <span class="badge badge-primary">3</span>
                        Clone the Project in Attune
                         <i class="fa-solid fa-book fa-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://www.youtube.com/watch?v=GCWDI29rDV0"
                        target="_blank">
                        <span class="badge badge-primary">4</span>
                        Plan your Job(s)
                        <i class="fa-brands fa-youtube fa-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://www.youtube.com/watch?v=b7DhFcURkZg"
                        target="_blank">
                        <span class="badge badge-primary">5</span>
                        Run your Job(s)
                        <i class="fa-brands fa-youtube fa-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
            </p>
            <p class="lead text-center">
                You've automated: <strong>Create Win2022 autounattend Single ISO on Linux</strong>
            </p>
            <hr class="my-4 text-center">
            <div class="col px-0">
                <p class="text-center">
                    Get the most out of automation with our get started
                    videos, product demonstrations, and more.
                </p>
                <p class="lead text-center">
                    <a class="btn btn-primary btn-lg"
                       href="https://www.servertribe.com/learn/"
                       target="_blank"
                       role="button">
                        Learn Attune Automation
                    </a>
                </p>
            </div>
        </div>

        <div class="row">
            <p>The following steps will guide you through the manual process.</p>
        </div>

<!-- Blueprint Steps -->


        



                    <div class="row pt-5">
                        <h3 id="checkinputparametervaluesforwindowsserversingleisokickstart">
                            <a href="#checkinputparametervaluesforwindowsserversingleisokickstart">
                                <strong>Step 1 -</strong> Check Input Parameter Values for Windows Server Single ISO Kickstart
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>










                        <div class="row">
                            <p>
                                Connect via ssh:
                            </p>
                        </div>
                        <div class="row py-1">
                            <code class="language-sql">
ssh {automationworkerlinuxuser}@{automationworkerlinuxnode}
                            </code>
                        </div>



    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
if ! {isWinServerBios} &amp;&amp; ! {isWinServerUefi}
then
    echo &quot;Please set one of &#x27;isWinServerBios&#x27; or &#x27;isWinServerUefi&#x27; to true to install Windows Server 2016, 2019 or 2022.&quot;
    exit 1
else
    echo &quot;Ok.&quot;
fi
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="cleanupbuildfilesandisos">
                            <a href="#cleanupbuildfilesandisos">
                                <strong>Step 2 -</strong> Clean Up Build Files and ISOs
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Deletes the following:
1. Build directory at <code>{automationWorkerBaseDirectory}/build-{newOsNode.fqn}</code>.<code>2. Kickstart ISO at</code>{automationWorkerBaseDirectory}/kickstart_{newOsNode.fqn}.iso<code>.
3. Drivers ISO at</code>{automationWorkerBaseDirectory}/drivers_{newOsNode.fqn}.iso`.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
DIR=&quot;{automationWorkerBaseDirectory}/build-{newOsNode.fqn}&quot;
[[ -d ${DIR} ]] &amp;&amp; rm -rf ${DIR} &amp;&amp; echo &quot;Removed ${DIR}&quot; || \
    echo &quot;No directory to remove.&quot;

ISO={automationWorkerBaseDirectory}/*{newOsNode.fqn}.iso
[[ -f ${ISO} ]] &amp;&amp; rm -fv ${ISO} || echo &quot;No ISO to remove.&quot;
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="deploywin2022dvdiso">
                            <a href="#deploywin2022dvdiso">
                                <strong>Step 3 -</strong> Deploy Win2022 DVD ISO
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Deploys Windows Server 2022 ISO to <code>{automationWorkerBaseDirectory}/build-{newOsNode.fqn}</code>.</p>
                            </p>
                        </div>
                    </div>









    

    



    <div class="row">
        <p>
            <p>Download from https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2022.</p>
        </p>
        <p>
            Copy the File(s)
            <strong>WIN_Raw_Win2022_ISO.tar</strong>
            to the target node.
        </p>
        <p>
            <strong>Deploy the File(s)</strong> here:
        </p>
    </div>
    <div class="row py-1">
        <code class="language-bash">
{automationWorkerBaseDirectory}/build-{newOsNode.fqn}, relative to the home directory
        </code>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="extractwindowsbootimg">
                            <a href="#extractwindowsbootimg">
                                <strong>Step 4 -</strong> Extract Windows boot.img
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Extracts the <code>boot.img</code> from the ISO. This is required for passing to <code>mkisofs</code> to regenerate a bootable BIOS ISO.</p>
<p>Only applies BIOS kickstarts so if any of these parameters are set the string 'true':</p>
<ol>
<li>isWin10Bios</li>
<li>isWinServerBios</li>
</ol>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
if {isWin10Bios} || {isWinServerBios}
then

    # Extract the boot.img out of the WinPE ISO
    
    cd {automationWorkerBaseDirectory}/build-{newOsNode.fqn}
    
    # Case insensitve globbing
    shopt -s nocaseglob
    
    # Set the filename of the ISO
    F=$(ls *.iso)
    
    # Get the Boot image offset
    OFFSET=`isoinfo -d -i $F | grep Bootoff | cut  -c21-`
    
    # Extract the boot.img.
    dd if=$F of=boot.img bs=2048 count=8 skip=$OFFSET
    
else
    echo &quot;Skipping for UEFI ISO creation.&quot;
fi
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="extractwindowsiso">
                            <a href="#extractwindowsiso">
                                <strong>Step 5 -</strong> Extract Windows ISO
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Extracts the Windows ISO.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
cd {automationWorkerBaseDirectory}/build-{newOsNode.fqn}

# Case insensitve globbing
shopt -s nocaseglob

if ls | grep -q *iso
then
    
    ISO=&quot;$(echo *iso)&quot;
    echo &quot;ISO is $ISO&quot;
    
    7z x &quot;${ISO}&quot;
    
    rm -v &quot;${ISO}&quot;
else
    echo &quot;ISO is already extracted.&quot;
fi
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="deploypostsetuppowershellscript">
                            <a href="#deploypostsetuppowershellscript">
                                <strong>Step 6 -</strong> Deploy Post Setup PowerShell Script
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Deploys the post install setup PowerShell script <code>post_install_setup.ps1</code>.</p>
                            </p>
                        </div>
                    </div>









    

    



    <div class="row">
        <p>
            <p>This file is called by the "<FirstLogonCommands>" section in the autounattend.xml file.</p>
<p>This script is run once post installation of the WIndows operating system.</p>
        </p>
        <p>
            Copy the File(s)
            <strong>Post_Install_Setup_PowerShell_Script.tar</strong>
            to the target node.
        </p>
        <p>
        </p>
    </div>
    <div class="row py-1">
        <code class="language-bash">
{automationWorkerBaseDirectory}/build-{newOsNode.fqn}, relative to the home directory
        </code>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="deploywindowsunattendedconfig">
                            <a href="#deploywindowsunattendedconfig">
                                <strong>Step 7 -</strong> Deploy Windows Unattended Config
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Deploys the generic autounattend.xml.</p>
<p>Set one of these 'true' depending on whether you want Win10 or Windows Server for BIOS or UEFI boot methods.</p>
<ol>
<li>isWin10Bios</li>
<li>isWin10Uefi</li>
<li>isWinServerBios</li>
<li>isWinServerUefi</li>
</ol>
<p>Set isWinPEKickstart to 'true' for WinPE kickstarts.</p>
                            </p>
                        </div>
                    </div>









    

    



    <div class="row">
        <p>
            <p>For these Windows versions:
* WIndows Desktop 10
* WIndows Server 2016
* WIndows Server 2019
* WIndows Server 2022</p>
<p>For these boot methods:
* BIOS
* UEFI</p>
        </p>
        <p>
            Copy the File(s)
            <strong>Windows_Unattended_config.tar</strong>
            to the target node.
        </p>
        <p>
        </p>
    </div>
    <div class="row py-1">
        <code class="language-bash">
{automationWorkerBaseDirectory}/build-{newOsNode.fqn}, relative to the home directory
        </code>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="copydriversdropinfolder">
                            <a href="#copydriversdropinfolder">
                                <strong>Step 8 -</strong> Copy Drivers Drop in Folder
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Copies the contents of the drivers drop in folder at <code>{automationWorkerBaseDirectory}/drivers-{newOsNode.fqn}</code> to <code>{automationWorkerBaseDirectory}/build-{newOsNode.fqn}/drivers</code>.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
cd {automationWorkerBaseDirectory}/build-{newOsNode.fqn}

DRIVERS_DROP_IN_FOLDER=&quot;{automationWorkerBaseDirectory}/drivers-{newOsNode.fqn}&quot;
DESTINATION_DRIVERS_FOLDER=&quot;drivers&quot;

mkdir --verbose &quot;${DESTINATION_DRIVERS_FOLDER}&quot;

if [ -d &quot;${DRIVERS_DROP_IN_FOLDER}&quot; ]
then

    cp --verbose --recursive &quot;${DRIVERS_DROP_IN_FOLDER}&quot;/* \
        &quot;${DESTINATION_DRIVERS_FOLDER}&quot;
else
    echo &quot;Drivers drop in folder ${DRIVERS_DROP_IN_FOLDER} does not exist. No drivers copied.&quot;
fi
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="createbiosbootiso">
                            <a href="#createbiosbootiso">
                                <strong>Step 9 -</strong> Create BIOS Boot ISO
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Creates a BIOS bootable Windows ISO called <code>kickstart_{newOsNode.fqn}.iso</code> from the contents in folder <code>{automationWorkerBaseDirectory}/build-{newOsNode.fqn}</code>.</p>
<p>Only applies BIOS kickstarts so if any of these parameters are set the string 'true':</p>
<ol>
<li>isWin10Bios</li>
<li>isWinServerBios</li>
</ol>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
if {isWin10Bios} || {isWinServerBios} 
then

    cd {automationWorkerBaseDirectory}/build-{newOsNode.fqn}
    
    mkisofs -o {automationWorkerBaseDirectory}/kickstart_{newOsNode.fqn}.iso \
        -b boot.img -no-emul-boot -c BOOT.CAT \
        -iso-level 3 -udf -joliet-long -relaxed-filenames -allow-limited-size \
        -J -l -D -N -V &quot;KS_WIN&quot; .
        
else
    echo &quot;Skipping for UEFI ISO creation.&quot;
fi
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="performcreateuefiforsingleiso">
                            <a href="#performcreateuefiforsingleiso">
                                <strong>Step 10 -</strong> Perform Create UEFI for Single ISO
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Creates the Windows ISO again from the contents of the <code>build-{newOsNode.fqn}</code> folder.</p>
                            </p>
                        </div>
                    </div>





    




    



                    <div class="row pt-5">
                        <h4 id="createemptyuefiforsingleiso">
                            <a href="#createemptyuefiforsingleiso">
                                <strong>Step 10.1 -</strong> Create Empty UEFI for Single ISO 
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Creates a UEFI Boot enabled MSDOS ISO that is large enough to fit the contents of the <code>build-{newOsNode.fqn}</code> directory at <code>{automationWorkerBaseDirectory}/kickstart_{newOsNode.fqn}.iso</code>.</p>
<p>Only applies UEFI kickstarts so if any of these parameters are set the string 'true':</p>
<ol>
<li>isWin10Uefi</li>
<li>isWinServerUefi</li>
</ol>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
if {isWin10Uefi} || {isWinServerUefi}
then
    cd &quot;{automationWorkerBaseDirectory}&quot;
    
    bytes=$(du --summarize &quot;build-{newOsNode.fqn}&quot; | awk &#x27;{print $1}&#x27;)
    ((bytes=bytes+10000))
    
    mkfs.msdos -C &quot;./kickstart_{newOsNode.fqn}.iso&quot; &quot;${bytes}&quot;
    
else
    echo &quot;Skipping for BIOS ISO creation.&quot;
fi
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="mountemptyuefiforsingleiso">
                            <a href="#mountemptyuefiforsingleiso">
                                <strong>Step 10.2 -</strong> Mount Empty UEFI for Single ISO
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Mounts the UEFI ISO to <code>{automationWorkerBaseDirectory}/build-{newOsNode.fqn}-uefi-mount</code>.</p>
<p>Only applies UEFI kickstarts so if any of these parameters are set the string 'true':</p>
<ol>
<li>isWin10Uefi</li>
<li>isWinServerUefi</li>
</ol>
                            </p>
                        </div>
                    </div>










                        <div class="row">
                            <p>
                                Connect via ssh:
                            </p>
                        </div>
                        <div class="row py-1">
                            <code class="language-sql">
ssh {automationworkerlinuxuserroot}@{automationworkerlinuxnode}
                            </code>
                        </div>



    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
if {isWin10Uefi} || {isWinServerUefi}
then

    cd &quot;{automationWorkerBaseDirectory}&quot;
    
    MOUNT_FOLDER=&quot;build-{newOsNode.fqn}-uefi-mount&quot;
    
    mkdir --verbose &quot;${MOUNT_PATH}&quot;
    
    mount &quot;./kickstart_{newOsNode.fqn}.iso&quot; &quot;${MOUNT_FOLDER}&quot;
    
else
    echo &quot;Skipping for BIOS ISO creation.&quot;
fi
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="movefilestouefimount">
                            <a href="#movefilestouefimount">
                                <strong>Step 10.3 -</strong> Move Files to UEFI Mount
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Move contents of <code>build-{newOsNode.fqn}</code> to <code>build-{newOsNode.fqn}-uefi-mount</code>.</p>
<p>Only applies UEFI kickstarts so if any of these parameters are set the string 'true':</p>
<ol>
<li>isWin10Uefi</li>
<li>isWinServerUefi</li>
</ol>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
if {isWin10Uefi} || {isWinServerUefi}
then

    cd &quot;{automationWorkerBaseDirectory}&quot;
    
    mv --verbose &quot;build-{newOsNode.fqn}/*&quot; &quot;build-{newOsNode.fqn}-uefi-mount&quot;
    
else
    echo &quot;Skipping for BIOS ISO creation.&quot;
fi
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="unmountsingleisouefimount">
                            <a href="#unmountsingleisouefimount">
                                <strong>Step 10.4 -</strong> Unmount Single ISO UEFI Mount
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Unmounts <code>{automationWorkerBaseDirectory}/build-{newOsNode.fqn}-uefi-mount</code>. </p>
<p>This writes the contents of <code>build-{newOsNode.fqn}-uefi-mount</code> to the MSDOS ISO <code>{automationWorkerBaseDirectory}/kickstart_{newOsNode.fqn}.iso</code> created in step <code>Create Empty UEFI for Single ISO</code>. </p>
<p>Only applies UEFI kickstarts so if any of these parameters are set the string 'true':</p>
<ol>
<li>isWin10Uefi</li>
<li>isWinServerUefi</li>
</ol>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
if {isWin10Uefi} || {isWinServerUefi}
then

    MOUNT_FOLDER=&quot;build-{newOsNode.fqn}-uefi-mount&quot;
    MOUNT_PATH=&quot;{automationWorkerBaseDirectory}/${MOUNT_FOLDER}&quot;
    
    if df -h | grep --ignore-case \
        --quiet \
        &quot;${MOUNT_PATH}&quot;
    then
    
        cd &quot;{automationWorkerBaseDirectory}&quot;
        
        umount --verbose &quot;${MOUNT_FOLDER}&quot;
    else
        echo &quot;${MOUNT_PATH} is not mounted. Skipping.&quot;
    fi
    
else
    echo &quot;Skipping for BIOS ISO creation.&quot;
fi
                </code>
            </pre>
        </div>
    </div>






        



                    <div class="row pt-5">
                        <h3 id="cleanupbuildfilesanddriversfiles">
                            <a href="#cleanupbuildfilesanddriversfiles">
                                <strong>Step 11 -</strong> Clean up Build Files and Drivers Files
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Deletes the following:
1. Build directory at <code>{automationWorkerBaseDirectory}/build-{newOsNode.fqn}</code>.
2. Drivers drop in directory at <code>{automationWorkerBaseDirectory}/drivers-{newOsNode.fqn}</code>.</p>
                            </p>
                        </div>
                    </div>










                        <div class="row">
                            <p>
                                Connect via ssh:
                            </p>
                        </div>
                        <div class="row py-1">
                            <code class="language-sql">
ssh {automationworkerlinuxuser}@{automationworkerlinuxnode}
                            </code>
                        </div>



    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
DIR=&quot;{automationWorkerBaseDirectory}/build-{newOsNode.fqn}&quot;
if [ -d &quot;${DIR}&quot; ]
then
    rm -rf &quot;${DIR}&quot; &amp;&amp; echo &quot;Removed ${DIR}&quot;
else
    echo &quot;No directory to remove.&quot;
fi

DIR=&quot;{automationWorkerBaseDirectory}/drivers-{newOsNode.fqn}&quot;
if [ -d &quot;${DIR}&quot; ]
then
    rm -rf &quot;${DIR}&quot; &amp;&amp; echo &quot;Removed ${DIR}&quot;
else
    echo &quot;No directory to remove.&quot;
fi
                </code>
            </pre>
        </div>
    </div>






                    <div class="row pt-5">
                        <div class="col">
                            <h2>Completed</h2>
                            <p>
                                You have completed this instruction.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

<!-- Download Attune Ad -->

            <div class="toc col-lg-2 px-0">
                <div class="container px-0 pt-3 pl-5">
                    <div class="card border-light mb-3" style="max-width: 18rem;">
                        <div class="card-body attune-ad">
                            <img
                                src="https://www.servertribe.com/wp-content/uploads/2022/06/AttuneLogoV2_powered_by.png"
                                alt="Attune - Powered by ServerTribe"
                                class="img-fluid">
                            <p class="card-title mt-3 text-center">
                                <strong>Automate with Attune</strong>
                            </p>
                            <p class="card-text text-center">
                                Download the Attune Community Edition.
                            </p>
                            <p class="text-center">
                                <a href="https://www.servertribe.com/download-attune-registration/"
                                   class="btn btn-primary mt-3">
                                    DOWNLOAD!!!
                                </a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>

        </div>

<!-- Join Discord -->

        <div class="row py-5">
            <div class="jumbotron">
              <h1 class="display-4 text-center">
                  Discuss this Project in Discord
              </h1>
              <p class="lead">

                  Join our Discord channel and connect with like-minded individuals who
                  share your passion. Engage in lively discussions, gain valuable insights,
                  and stay updated on the latest trends in our industry. Don't miss out on
                  this opportunity to network, learn, and grow together.
              </p>
              <hr class="my-4 text-center">
                <div class="col px-0">
                  <p class="text-center">
                      Click the link below and become a part of our vibrant community on
                      Discord today!
                  </p>
                  <p class="lead text-center">
                    <a class="btn btn-primary btn-lg"
                       href="https://discord.com/invite/3YpJsagqUn"
                       role="button">
                        Join NOW!!!
                    </a>
                  </p>
                </div>
            </div>
        </div>

    </div>
</div>

<!-- Project Footer -->

<footer class="footer fixed-bottom bg-white border-top box-shadow">
      <div class="container px-0">
          <div class="row">
              <div class="col px-0">
                  <a class="my-0 mr-lg-auto"
                     href="https://www.servertribe.com/"
                     target="_blank">
                      <img
                          src="https://www.servertribe.com/wp-content/uploads/2022/06/AttuneLogoV2_powered_by.png"
                          alt="Attune - Powered by ServerTribe"
                          class="img-fluid navbar-img">
                  </a>
              </div>
          </div>
      </div>
</footer>


<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
<script
    src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
<script
    src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>

<script
    src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>

<script
    src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
<script
    src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>


</body>
</html>
