
<!doctype html>
<html lang="en">




<head>
    <title>How to Create Win10 BIOS autounattend WinPE ISO on Linux - Attune Automation</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="title"
          content="How to Create Win10 BIOS autounattend WinPE ISO on Linux - Attune Automation">
    <meta name="description"
          content="">
    <meta name="robots"
          content="follow, index, max-snippet:-1, max-video-preview:-1, max-image-preview:large">

    <meta property="og:locale" content="en_AU" />
    <meta property="og:type" content="article" />
    <meta property="og:title"
          content="HowTo Create Win10 BIOS autounattend WinPE ISO on Linux - Attune Automation" />
    <meta property="og:description" content="" />
    <meta property="og:site_name" content="Attune Automation" />
    <meta property="article:section" content="IT Instruction" />

    <meta name="twitter:title"
          content="How to Create Win10 BIOS autounattend WinPE ISO on Linux - Attune Automation" />
    <meta name="twitter:description" content="" />

    <link rel="icon" href="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-32x32.png" sizes="32x32">
    <link rel="icon" href="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-192x192.png" sizes="192x192">
    <link rel="apple-touch-icon" href="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-180x180.png">
    <meta name="msapplication-TileImage" content="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-270x270.png">
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
          crossorigin="anonymous">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="styles/style.css">

    <!-- Google tag (gtag.js) -->
    <script async
            src="https://www.googletagmanager.com/gtag/js?id=G-5TZQZNDJCD"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-5TZQZNDJCD');
    </script>
</head>


<body>

<!-- Project NavBar -->

<div class="bg-white border-bottom box-shadow sticky-top mb-3">
<div class="container px-0">
    <div class="row px-0">
        <div class="col d-flex flex-column flex-lg-row align-items-center px-0
            py-3">
            <a class="navbar-brand my-0 mr-lg-auto"
                  href="https://www.servertribe.com/"
                  target="_blank">
                    <img
                        src="https://www.servertribe.com/wp-content/uploads/2022/06/AttuneLogoV2_powered_by.png"
                        alt="Attune - Powered by ServerTribe"
                        class="img-fluid navbar-img">
            </a>
            <nav class="my-2 my-lg-0 mr-lg-3">
                <a class="p-2 text-dark" href="http://doc.servertribe.com/"
                   target="_blank">
                    Documentation
                </a>
                <a class="p-2 text-dark"
                   href="https://discord.com/invite/3YpJsagqUn"
                   target="_blank">
                    Discord
                </a>
                <a class="p-2 text-dark" href="https://github.com/Attune-Automation"
                   target="_blank">
                    GitHub
                </a>
                <a class="p-2 text-dark" href="https://www.servertribe.com/learn/"
                   target="_blank">
                    Learn
                </a>
            </nav>
            <a class="btn btn-outline-primary"
               href="https://www.servertribe.com/download-attune-registration/"
               target="_blank">
                Download NOW!
            </a>
        </div>
    </div>
</div></div>

<!-- Project breadcrumbs -->

<!-- Project breadcrumbs -->
<div class="container px-0">
    <div class="row">
        <nav class="col px-0" aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item">
                    <a href="index.html">
                    Automate Windows Installation with autounattend
                    </a>
                </li>
                <li class="breadcrumb-item active" aria-current="page">
                    <strong>Create Win10 BIOS autounattend WinPE ISO on Linux</strong>
                </li>
            </ol>
        </nav>
    </div>
</div>

<!-- Blueprint Header -->

<div class="container px-0">
    <!-- Blueprint name and description -->
    <div class="row">
        <div class="col px-0">
            <h1 class="text-left">
                How to Create Win10 BIOS autounattend WinPE ISO on Linux
            </h1>
        </div>
    </div>

<!-- Blueprint Description -->
    <div class="row pt-4">
        <div class="col-6 px-0">
            <h6 class="text-left">
                This documentation is generated by
                <a href="https://www.servertribe.com/"
                    class="badge badge-primary"
                    target="_blank">
                    Attune
                </a>
            </h6>
        </div>
        <div class="col-6 align-self-end text-right px-0">
            <h6 class="text-right">
                <a href="https://www.youtube.com/@servertribe"
                    class="badge badge-secondary"
                    target="_blank">
                    YouTube
                </a>
                <a href="https://github.com/Attune-Automation"
                    class="badge badge-secondary"
                    target="_blank">
                    GitHub
                </a>
                <a href="https://discord.com/invite/3YpJsagqUn"
                    class="badge badge-secondary"
                    target="_blank">
                    Discord
                </a>
                <a href="https://www.linkedin.com/company/servertribe/"
                    class="badge badge-secondary"
                    target="_blank">
                    LinkedIn
                </a>
                <a href="http://doc.servertribe.com/"
                    class="badge badge-secondary"
                    target="_blank">
                    Documentation
                </a>
            </h6>
        </div>
    </div>
    <hr>
</div>

<div class="documentation">
    <div class="container px-0">
        <div class="row">

<!-- Blueprint ToC -->


            <div class="toc col-lg-2 px-0 pr-5">
                <div class="container px-0 pt-3">
                    <p class="pb-2">
                        <strong>Contents</strong>
                    </p>
                    <p class="text-muted">
                        <a href="#top">
                            <strong>Create Win10 BIOS autounattend WinPE ISO on Linux</strong>
                        </a>
                    </p>


    
        

                    <p class="text-muted pt-2">
                        <a href="#cleanbuildfiles">
                            <strong>Step 1 -</strong> Clean Build Files
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#lincopywinpewin2019plainuefiisotowinpeiso">
                            <strong>Step 2 -</strong> LIN Copy winpe_win2019_plain_uefi.iso to winpe.iso
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#linextractwinpeisotowinpestaging">
                            <strong>Step 3 -</strong> LIN Extract winpe.iso to winpe_staging
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#lindeploystartnetcmdforwinpe">
                            <strong>Step 4 -</strong> LIN Deploy startnet.cmd for WinPE
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#deploywin10biosunattendedconfig">
                            <strong>Step 5 -</strong> Deploy Win10 BIOS Unattended Config
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#createpostsetupwim">
                            <strong>Step 6 -</strong> Create Post Setup WIM
                        </a>
                    </p>
    
        

                    <p class="text-muted pt-2">
                        <a href="#deploypostsetuppowershellscript">
                            <strong>Step 6.1 -</strong> Deploy Post Setup PowerShell Script
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#movepostsetuppowershellscripttopostinstallwimfolder">
                            <strong>Step 6.2 -</strong> Move Post Setup PowerShell Script to post_install_wim Folder
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#createpostinstallwimwindowsimage">
                            <strong>Step 6.3 -</strong> Create post_install.wim Windows Image
                        </a>
                    </p>


        

                    <p class="text-muted pt-2">
                        <a href="#modifywinpebootwim">
                            <strong>Step 7 -</strong> Modify WinPE boot.wim
                        </a>
                    </p>
    
        

                    <p class="text-muted pt-2">
                        <a href="#lincreatebootwimmountfolder">
                            <strong>Step 7.1 -</strong> LIN Create boot.wim Mount Folder
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#linwimlibmountbootwimtowinpebootimagedirfolder">
                            <strong>Step 7.2 -</strong> LIN wimlib Mount BOOT.WIM to WinPE_BootImageDir Folder
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#linmovefilestobootwim">
                            <strong>Step 7.3 -</strong> LIN Move Files to boot.wim
                        </a>
                    </p>
    
        

                    <p class="text-muted pt-2">
                        <a href="#linmovestartnetcmdtobootwim">
                            <strong>Step 7.3.1 -</strong> LIN Move startnet.cmd to boot.wim
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#linmoveautounattendxmltobootwim">
                            <strong>Step 7.3.2 -</strong> LIN Move autounattend.xml to boot.wim
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#linmovepostinstallwimtobootwim">
                            <strong>Step 7.3.3 -</strong> LIN Move post_install.wim to boot.wim
                        </a>
                    </p>


        

                    <p class="text-muted pt-2">
                        <a href="#linwimlibunmountbootwim">
                            <strong>Step 7.4 -</strong> LIN wimlib Unmount boot.wim
                        </a>
                    </p>


        

                    <p class="text-muted pt-2">
                        <a href="#linrecreatebiosbootwinpeisofromwinpestaging">
                            <strong>Step 8 -</strong> LIN Recreate BIOS Boot WinPE ISO from winpe_staging
                        </a>
                    </p>


                </div>
            </div>

<!-- Blueprint Contents -->
            <div class="col-lg-8 pt-3">
                <div class="container">


        <div class="jumbotron">
            <p class="display-3 text-center">
                <strong>Automate This</strong>
            </p>
            <p class="lead text-center">
                Use the <strong>Attune GUI</strong> for your Scripts
            </p>
            <p class="lead">
                <ol>
                    <a href="https://www.servertribe.com/download-attune-registration/"
                        target="_blank">
                        <span class="badge badge-primary">1</span>
                        Download Attune
                        <i class="fa-solid fa-download fa-beat-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://github.com/attune-Automation/"
                        target="_blank">
                        <span class="badge badge-primary">2</span>
                         Copy the Attune Project URL
                         <i class="fa-brands fa-github fa-fade"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://servertribe-attune.readthedocs.io/en/latest/howto/design_workspace/clone_project.html"
                        target="_blank">
                        <span class="badge badge-primary">3</span>
                        Clone the Project in Attune
                         <i class="fa-solid fa-book fa-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://www.youtube.com/watch?v=GCWDI29rDV0"
                        target="_blank">
                        <span class="badge badge-primary">4</span>
                        Plan your Job(s)
                        <i class="fa-brands fa-youtube fa-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://www.youtube.com/watch?v=b7DhFcURkZg"
                        target="_blank">
                        <span class="badge badge-primary">5</span>
                        Run your Job(s)
                        <i class="fa-brands fa-youtube fa-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
            </p>
            <p class="lead text-center">
                You've automated: <strong>Create Win10 BIOS autounattend WinPE ISO on Linux</strong>
            </p>
            <hr class="my-4 text-center">
            <div class="col px-0">
                <p class="text-center">
                    Get the most out of automation with our get started
                    videos, product demonstrations, and more.
                </p>
                <p class="lead text-center">
                    <a class="btn btn-primary btn-lg"
                       href="https://www.servertribe.com/learn/"
                       target="_blank"
                       role="button">
                        Learn Attune Automation
                    </a>
                </p>
            </div>
        </div>

        <div class="row">
            <p>The following steps will guide you through the manual process.</p>
        </div>

<!-- Blueprint Steps -->


        



                    <div class="row pt-5">
                        <h3 id="cleanbuildfiles">
                            <a href="#cleanbuildfiles">
                                <strong>Step 1 -</strong> Clean Build Files
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Deletes the build files and kickstart ISO.</p>
                            </p>
                        </div>
                    </div>










                        <div class="row">
                            <p>
                                Connect via ssh:
                            </p>
                        </div>
                        <div class="row py-1">
                            <code class="language-sql">
ssh {automationworkerlinuxuser}@{automationworkerlinuxnode}
                            </code>
                        </div>



    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
DIR=&quot;{automationWorkerBaseDirectory}/build-{newOsNode.fqn}&quot;
[[ -d ${DIR} ]] &amp;&amp; rm -rf ${DIR} &amp;&amp; echo &quot;Removed ${DIR}&quot; || \
    echo &quot;No directory to remove.&quot;

ISO=&quot;{automationWorkerBaseDirectory}/kickstart_{newOsNode.fqn}.iso&quot;
[[ -f ${ISO} ]] &amp;&amp; rm -fv ${ISO} || echo &quot;No ISO to remove.&quot;
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="lincopywinpewin2019plainuefiisotowinpeiso">
                            <a href="#lincopywinpewin2019plainuefiisotowinpeiso">
                                <strong>Step 2 -</strong> LIN Copy winpe_win2019_plain_uefi.iso to winpe.iso
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Makes a copy of the <code>winpe_win2019_plain_uefi.iso</code> as <code>winpe.iso</code> in the folder <code>{automationWorkerBaseDirectory}/build-{newOsNode.fqn</code>.</p>
<p>This ISO is UEFI bootable and works for:</p>
<ol>
<li>Windows Desktop 10</li>
<li>Windows Server 2016</li>
<li>Windows Server 2019</li>
<li>Windows Server 2022</li>
</ol>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
PATH=&quot;{automationWorkerBaseDirectory}/build-{newOsNode.fqn}&quot;
mkdir --parents &quot;${PATH}&quot;
cd &quot;${PATH}&quot;
cp --verbose &quot;../winpe_win2019_plain_uefi.iso&quot; &quot;winpe.iso&quot;
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="linextractwinpeisotowinpestaging">
                            <a href="#linextractwinpeisotowinpestaging">
                                <strong>Step 3 -</strong> LIN Extract winpe.iso to winpe_staging
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Extract <code>winpe.iso</code> to a <code>winpe_staging</code> folder.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
cd {automationWorkerBaseDirectory}/build-{newOsNode.fqn}

FOLDER=winpe_staging
mkdir -p &quot;${FOLDER}&quot;

7z x winpe.iso -o&quot;${FOLDER}&quot;
                </code>
            </pre>
        </div>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="lindeploystartnetcmdforwinpe">
                            <a href="#lindeploystartnetcmdforwinpe">
                                <strong>Step 4 -</strong> LIN Deploy startnet.cmd for WinPE
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Deploys <code>startnet.cmd</code>.</p>
<p>This script is run by WinPE.</p>
                            </p>
                        </div>
                    </div>









    

    



    <div class="row">
        <p>
            <p>The startnet.cmd is run by WinPE. This script:
1. Installs drivers from "attune_drivers".
2. Sets the IP address.
3. Mounts the Samba server that hosts the extracted Windows ISOs as the "Z" drive.
4. Runs Windows setup.exe.</p>
<p>The Mako parameter "windowsFolderOnSamba" can have these values:</p>
<ul>
<li>windows10</li>
<li>windows2016</li>
<li>windows2019</li>
<li>windows2022</li>
</ul>
        </p>
        <p>
            Copy the File(s)
            <strong>WinPE_startnetcmd.tar</strong>
            to the target node.
        </p>
        <p>
        </p>
    </div>
    <div class="row py-1">
        <code class="language-bash">
{automationWorkerBaseDirectory}/build-{newOsNode.fqn}, relative to the home directory
        </code>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="deploywin10biosunattendedconfig">
                            <a href="#deploywin10biosunattendedconfig">
                                <strong>Step 5 -</strong> Deploy Win10 BIOS Unattended Config
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Deploys a Windows 10 <code>autounattend.xml</code> file. This works with Windows 10.</p>
                            </p>
                        </div>
                    </div>









    

    



    <div class="row">
        <p>
            <p>Windows Desktop 10 unattended.xml file.</p>
        </p>
        <p>
            Copy the File(s)
            <strong>Win10_BIOS_Unattended_Config.tar</strong>
            to the target node.
        </p>
        <p>
        </p>
    </div>
    <div class="row py-1">
        <code class="language-bash">
{automationWorkerBaseDirectory}/build-{newOsNode.fqn}, relative to the home directory
        </code>
    </div>





        



                    <div class="row pt-5">
                        <h3 id="createpostsetupwim">
                            <a href="#createpostsetupwim">
                                <strong>Step 6 -</strong> Create Post Setup WIM
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Creates a <code>post_install.wim</code> Windows Imaging Format file.</p>
<p>The purpose of this file is to overlay onto the <code>C</code> drive any files we want for the Windows Installer to use.</p>
<p>in this case we want to deploy a post install setup PowerShell script at <code>C:\post_install_setup.ps1</code> that is called by <code>autounattend.xml</code> <code>&lt;FirstLogonCommands&gt;</code>'s section.</p>
                            </p>
                        </div>
                    </div>





    




    



                    <div class="row pt-5">
                        <h4 id="deploypostsetuppowershellscript">
                            <a href="#deploypostsetuppowershellscript">
                                <strong>Step 6.1 -</strong> Deploy Post Setup PowerShell Script
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Deploys the post install setup PowerShell script <code>post_install_setup.ps1</code>.</p>
                            </p>
                        </div>
                    </div>









    

    



    <div class="row">
        <p>
            <p>This file is called by the "<FirstLogonCommands>" section in the autounattend.xml file.</p>
<p>This script is run once post installation of the WIndows operating system.</p>
        </p>
        <p>
            Copy the File(s)
            <strong>Post_Install_Setup_PowerShell_Script.tar</strong>
            to the target node.
        </p>
        <p>
        </p>
    </div>
    <div class="row py-1">
        <code class="language-bash">
{automationWorkerBaseDirectory}/build-{newOsNode.fqn}, relative to the home directory
        </code>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="movepostsetuppowershellscripttopostinstallwimfolder">
                            <a href="#movepostsetuppowershellscripttopostinstallwimfolder">
                                <strong>Step 6.2 -</strong> Move Post Setup PowerShell Script to post_install_wim Folder
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Moves <code>post_install_setup.ps1</code> script to the <code>post_install_wim</code> folder.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
cd {automationWorkerBaseDirectory}/build-{newOsNode.fqn}
mkdir --parents post_install_wim
mv --verbose post_install_setup.ps1 post_install_wim
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="createpostinstallwimwindowsimage">
                            <a href="#createpostinstallwimwindowsimage">
                                <strong>Step 6.3 -</strong> Create post_install.wim Windows Image
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Moves <code>post_install_setup.ps1</code> into the folder <code>post_install_wim</code>.</p>
<p>The folder <code>post_install_wim</code> is the staging folder for creating the <code>post_install.wim</code> Windows Imaging Format file.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
DIR=&quot;{automationWorkerBaseDirectory}/build-{newOsNode.fqn}&quot;
cd &quot;${DIR}&quot;

echo &quot;We are in ${DIR}&quot;

SOURCE=&quot;post_install_wim&quot;
WIMFILE=&quot;post_install.wim&quot;

echo &quot;Creating ${WIMFILE} from directory ${SOURCE}.&quot;

wimcapture &quot;${SOURCE}&quot; &quot;${WIMFILE}&quot; --check
                </code>
            </pre>
        </div>
    </div>






        



                    <div class="row pt-5">
                        <h3 id="modifywinpebootwim">
                            <a href="#modifywinpebootwim">
                                <strong>Step 7 -</strong> Modify WinPE boot.wim
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Appends these files to WinPE's <code>SOURCES/BOOT.WIM</code></p>
<ol>
<li><code>startnet.cmd</code></li>
<li><code>autounattend.xml</code></li>
<li><code>post_install.wim</code></li>
</ol>
                            </p>
                        </div>
                    </div>





    




    



                    <div class="row pt-5">
                        <h4 id="lincreatebootwimmountfolder">
                            <a href="#lincreatebootwimmountfolder">
                                <strong>Step 7.1 -</strong> LIN Create boot.wim Mount Folder
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Creates a directory <code>WinPE_BootImageDir</code> for mounting <code>winpe_staging/SOURCES/BOOT.WIM</code>.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
cd {automationWorkerBaseDirectory}/build-{newOsNode.fqn}

WinPE_BootImageDir=&quot;WinPE_BootImageDir&quot;
if [ ! -d WinPE_BootImageDir ]
then
    mkdir $WinPE_BootImageDir
fi
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="linwimlibmountbootwimtowinpebootimagedirfolder">
                            <a href="#linwimlibmountbootwimtowinpebootimagedirfolder">
                                <strong>Step 7.2 -</strong> LIN wimlib Mount BOOT.WIM to WinPE_BootImageDir Folder
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Mounts <code>winpe_staging/SOURCES/BOOT.WIM</code> to <code>WinPE_BootImageDir</code>.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
cd {automationWorkerBaseDirectory}/build-{newOsNode.fqn}
wimmountrw winpe_staging/SOURCES/BOOT.WIM WinPE_BootImageDir
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="linmovefilestobootwim">
                            <a href="#linmovefilestobootwim">
                                <strong>Step 7.3 -</strong> LIN Move Files to boot.wim
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Moves these files to the <code>winpe_staging/SOURCES/BOOT.WIM</code> mounted folder <code>WinPE_BootImageDir</code>:</p>
<ol>
<li><code>startnet.cmd</code></li>
<li><code>autounattend.xml</code></li>
<li><code>post_install.wim</code></li>
</ol>
                            </p>
                        </div>
                    </div>





    




    



                    <div class="row pt-5">
                        <h5 id="linmovestartnetcmdtobootwim">
                            <a href="#linmovestartnetcmdtobootwim">
                                <strong>Step 7.3.1 -</strong> LIN Move startnet.cmd to boot.wim
                            </a>
                        </h5>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Moves <code>startnet.cmd</code> to the folder <code>WinPE_BootImageDir/Windows/System32</code>.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
cd {automationWorkerBaseDirectory}/build-{newOsNode.fqn}

mv --verbose startnet.cmd \
    &quot;WinPE_BootImageDir/Windows/System32&quot;
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h5 id="linmoveautounattendxmltobootwim">
                            <a href="#linmoveautounattendxmltobootwim">
                                <strong>Step 7.3.2 -</strong> LIN Move autounattend.xml to boot.wim
                            </a>
                        </h5>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Moves <code>autounattend.xml</code> to the folder <code>WinPE_BootImageDir</code>.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
cd {automationWorkerBaseDirectory}/build-{newOsNode.fqn}
mv --verbose autounattend.xml WinPE_BootImageDir
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h5 id="linmovepostinstallwimtobootwim">
                            <a href="#linmovepostinstallwimtobootwim">
                                <strong>Step 7.3.3 -</strong> LIN Move post_install.wim to boot.wim
                            </a>
                        </h5>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Moves <code>post_install.wim</code> to the folder <code>WinPE_BootImageDir</code>.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
cd {automationWorkerBaseDirectory}/build-{newOsNode.fqn}

mv --verbose post_install.wim WinPE_BootImageDir
                </code>
            </pre>
        </div>
    </div>






    



                    <div class="row pt-5">
                        <h4 id="linwimlibunmountbootwim">
                            <a href="#linwimlibunmountbootwim">
                                <strong>Step 7.4 -</strong> LIN wimlib Unmount boot.wim
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Unmounts <code>{automationWorkerBaseDirectory}/build-{newOsNode.fqn}/WinPE_BootImageDir</code>.</p>
<p>This will write out changes back into <code>winpe_staging/SOURCES/BOOT.WIM</code>.</p>
                            </p>
                        </div>
                    </div>










                        <div class="row">
                            <p>
                                Connect via ssh:
                            </p>
                        </div>
                        <div class="row py-1">
                            <code class="language-sql">
ssh {kickstartworkerlinuxuser}@{kickstartworkerlinuxnode}
                            </code>
                        </div>



    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
cd {automationWorkerBaseDirectory}/build-{newOsNode.fqn}
wimunmount WinPE_BootImageDir --commit --check --rebuild
                </code>
            </pre>
        </div>
    </div>






        



                    <div class="row pt-5">
                        <h3 id="linrecreatebiosbootwinpeisofromwinpestaging">
                            <a href="#linrecreatebiosbootwinpeisofromwinpestaging">
                                <strong>Step 8 -</strong> LIN Recreate BIOS Boot WinPE ISO from winpe_staging
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Creates a BIOS bootable ISO at <code>{automationWorkerBaseDirectory}/kickstart_{newOsNode.fqn}.iso</code> from the WinPE staging directory <code>{automationWorkerBaseDirectory}/build-{newOsNode.fqn}/winpe_staging</code>. </p>
                            </p>
                        </div>
                    </div>










                        <div class="row">
                            <p>
                                Connect via ssh:
                            </p>
                        </div>
                        <div class="row py-1">
                            <code class="language-sql">
ssh {automationworkerlinuxuser}@{automationworkerlinuxnode}
                            </code>
                        </div>



    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
cd {automationWorkerBaseDirectory}/build-{newOsNode.fqn}

mkisofs -o {automationWorkerBaseDirectory}/kickstart_{newOsNode.fqn}.iso \
    -b boot.img -no-emul-boot -c BOOT.CAT \
    -iso-level 2 -udf -joliet-long -relaxed-filenames -allow-limited-size \
    -J -l -D -N -V &quot;KS_WIN&quot; winpe_staging
                </code>
            </pre>
        </div>
    </div>






                    <div class="row pt-5">
                        <div class="col">
                            <h2>Completed</h2>
                            <p>
                                You have completed this instruction.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

<!-- Download Attune Ad -->

            <div class="toc col-lg-2 px-0">
                <div class="container px-0 pt-3 pl-5">
                    <div class="card border-light mb-3" style="max-width: 18rem;">
                        <div class="card-body attune-ad">
                            <img
                                src="https://www.servertribe.com/wp-content/uploads/2022/06/AttuneLogoV2_powered_by.png"
                                alt="Attune - Powered by ServerTribe"
                                class="img-fluid">
                            <p class="card-title mt-3 text-center">
                                <strong>Automate with Attune</strong>
                            </p>
                            <p class="card-text text-center">
                                Download the Attune Community Edition.
                            </p>
                            <p class="text-center">
                                <a href="https://www.servertribe.com/download-attune-registration/"
                                   class="btn btn-primary mt-3">
                                    DOWNLOAD!!!
                                </a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>

        </div>

<!-- Join Discord -->

        <div class="row py-5">
            <div class="jumbotron">
              <h1 class="display-4 text-center">
                  Discuss this Project in Discord
              </h1>
              <p class="lead">

                  Join our Discord channel and connect with like-minded individuals who
                  share your passion. Engage in lively discussions, gain valuable insights,
                  and stay updated on the latest trends in our industry. Don't miss out on
                  this opportunity to network, learn, and grow together.
              </p>
              <hr class="my-4 text-center">
                <div class="col px-0">
                  <p class="text-center">
                      Click the link below and become a part of our vibrant community on
                      Discord today!
                  </p>
                  <p class="lead text-center">
                    <a class="btn btn-primary btn-lg"
                       href="https://discord.com/invite/3YpJsagqUn"
                       role="button">
                        Join NOW!!!
                    </a>
                  </p>
                </div>
            </div>
        </div>

    </div>
</div>

<!-- Project Footer -->

<footer class="footer fixed-bottom bg-white border-top box-shadow">
      <div class="container px-0">
          <div class="row">
              <div class="col px-0">
                  <a class="my-0 mr-lg-auto"
                     href="https://www.servertribe.com/"
                     target="_blank">
                      <img
                          src="https://www.servertribe.com/wp-content/uploads/2022/06/AttuneLogoV2_powered_by.png"
                          alt="Attune - Powered by ServerTribe"
                          class="img-fluid navbar-img">
                  </a>
              </div>
          </div>
      </div>
</footer>


<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
<script
    src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
<script
    src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>

<script
    src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>

<script
    src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
<script
    src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>


</body>
</html>
